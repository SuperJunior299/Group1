"use strict";var express=require("express"),_require=require("mongodb"),MongoClient=_require.MongoClient,port=process.env.PORT||3e3,app=express(),mongoose=require("mongoose"),dbName="Web",mongoUrl="mongodb+srv://lekhanhtoan07:T14012003oan@server1.h0nl7gl.mongodb.net/",collectionName="Test";app.use(express.urlencoded({extended:!0})),app.use(express.static("public")),app.use(express.json()),app.get("/index",function(e,n){n.render("index")}),app.get("/loginpage",function(e,n){n.render("loginpage")}),app.post("/loginpage",function(n,r){var s,t,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.body,t=s.username,o=s.password,e.next=3,regeneratorRuntime.awrap(User.findOne({username:t,password:o}));case 3:e.sent?r.status(200).json({message:"Login successful"}):r.status(401).json({message:"Login failed"});case 5:case"end":return e.stop()}})}),app.post("/index",function(n,r){var s,t,o,a,i,u,p,c,l,d,g;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.body,t=s.fullName,o=s.dateOfBirth,a=s.email,i=s.username,u=s.phone,p=s.password,e.prev=1,c=new MongoClient(mongoUrl,{useUnifiedTopology:!0}),e.next=5,regeneratorRuntime.awrap(c.connect());case 5:return l=c.db(dbName),d=l.collection(collectionName),e.next=9,regeneratorRuntime.awrap(d.findOne({$or:[{email:a},{username:i}]}));case 9:if(e.sent)return e.abrupt("return",r.send("Email or username already exists"));e.next=12;break;case 12:return g={fullName:t,dateOfBirth:o,email:a,username:i,phone:u,password:p},e.next=15,regeneratorRuntime.awrap(d.insertOne(g));case 15:1===e.sent.insertedCount?r.send("Registration failed."):r.send("Registration successful! "),c.close(),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(1),console.error(e.t0),r.status(500).send("Internal server error");case 24:case"end":return e.stop()}},null,null,[[1,20]])}),app.listen(port,function(){console.log("Server is running on port ".concat(port))});
//# sourceMappingURL=app.min.js.map
